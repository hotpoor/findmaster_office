// Generated by CoffeeScript 1.12.7
(function() {
  var Hs, root;

  root = typeof exports !== "undefined" && exports !== null ? exports : this;

  root.Hs || (root.Hs = {});

  Hs = root.Hs;

  $(function() {
    console.log("alipay coffee");
    return $("body").on("click", ".alipay", function(e) {
      var aim_id, alipay_app, block_id, chat_id, price, title, user_id;
      user_id = USER_ID;
      aim_id = USER_ID;
      block_id = $(this).attr("data-block-id");
      chat_id = $(this).attr("data-chat-id");
      price = $(this).attr("data-price");
      title = $(this).attr("data-title");
      alipay_app = $(this).attr("data-app");
      return $.ajax({
        url: "/api/pay/alipay/unified_plus",
        data: {
          price: price,
          user_id: aim_id,
          block_id: block_id,
          chat_id: chat_id,
          app: alipay_app,
          title: title
        },
        dataType: 'json',
        type: 'POST',
        success: function(data) {
          var new_blank;
          console.log(data);
          if (data.info === "ok") {
            new_blank = window.open('_blank');
            if (new_blank === null) {
              return window.location.href = data.redirect_url;
            } else {
              return new_blank.location = data.redirect_url;
            }
          } else {
            return alert(data.about);
          }
        },
        error: function(data) {
          console.log(data);
          return console.log("alipay_unifiedorder error");
        }
      });
    });
  });

}).call(this);
